<!DOCTYPE html>
<html>
<head>
    <title>Submarine Game</title>
    <style>
        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            border: 1px solid black;
            overflow: hidden;
            background-color: lightblue;
        }
        
        #submarine {
            position: absolute;
            width: 14%;
            height: 12%;
            bottom: 0;
            left: 43%;
        }
        
        .obstacle {
            position: absolute;
            width: 10%;
            height: 10%;
            bottom: 100%;
            background-image: url('https://iili.io/HsAfAX9.png');
            background-repeat: no-repeat;
            background-size: 100%;
        }
        
        #depth-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="depth-counter">Depth: 0m</div>
        <img id="submarine" src="https://iili.io/HsA3AWg.png" alt="Ocean Gate Titan Submersible PNG" border="0">
    </div>

    <audio id="bg-music" src="Titanic Theme Song (8-Bit)(1).wav" loop></audio>

    <script>
        const submarine = document.getElementById('submarine');
        const gameContainer = document.getElementById('game-container');
        const depthCounter = document.getElementById('depth-counter');
        const bgMusic = document.getElementById('bg-music');
        let score = 0;
        let gameSpeed = 2;
        let isGameOver = false;
        let depth = 0;
        let touchStartX = 0;
        let touchMoveX = 0;

        function moveSubmarine(event) {
            if (isGameOver) return;
            
            let leftPosition = parseInt(window.getComputedStyle(submarine).getPropertyValue('left'));
            
            if (event.type === 'keydown') {
                if (event.code === 'ArrowLeft') {
                    submarine.style.left = `${leftPosition - 10}px`;
                } else if (event.code === 'ArrowRight') {
                    submarine.style.left = `${leftPosition + 10}px`;
                }
            } else if (event.type === 'touchstart') {
                touchStartX = event.touches[0].clientX;
            } else if (event.type === 'touchmove') {
                touchMoveX = event.touches[0].clientX;
                let deltaX = touchMoveX - touchStartX;
                submarine.style.left = `${leftPosition + deltaX}px`;
                touchStartX = touchMoveX;
            }
        }

        function createObstacle() {
            if (isGameOver) return;

            const obstacle = document.createElement('div');
            obstacle.classList.add('obstacle');
            obstacle.style.left = `${Math.random() * 90}%`;
            gameContainer.appendChild(obstacle);

            let obstacleBottom = 100;
            let gameTimer = setInterval(() => {
                if (isGameOver) {
                    clearInterval(gameTimer);
                    obstacle.remove();
                    return;
                }

                if (obstacleBottom < 0) {
                    clearInterval(gameTimer);
                    obstacle.remove();
                    score++;
                }

                obstacle.style.bottom = `${obstacleBottom}%`;
                obstacleBottom -= gameSpeed;

                let submarineRect = submarine.getBoundingClientRect();
                let obstacleRect = obstacle.getBoundingClientRect();

                if (isColliding(submarineRect, obstacleRect)) {
                    gameOver();
                }
            }, 20);
        }

        function isColliding(rect1, rect2) {
            return (
                rect1.left < rect2.right &&
                rect1.right > rect2.left &&
                rect1.top < rect2.bottom &&
                rect1.bottom > rect2.top
            );
        }

        function increaseGameSpeed() {
            if (score > 0 && score % 5 === 0) {
                gameSpeed += 1;
            }
        }

        function updateDepth() {
            depth++;
            depthCounter.innerText = `Depth: ${depth}m`;
        }

        function gameOver() {
            isGameOver = true;
            bgMusic.pause();
            alert(`Game over! Your depth: ${depth}m`);
            resetGame();
        }

        function resetGame() {
            isGameOver = false;
            score = 0;
            gameSpeed = 2;
            depth = 0;
            depthCounter.innerText = 'Depth: 0m';
            while (gameContainer.firstChild) {
                gameContainer.firstChild.remove();
            }
        }

        function startGame() {
            window.addEventListener('keydown', moveSubmarine);
            window.addEventListener('touchstart', moveSubmarine);
            window.addEventListener('touchmove', moveSubmarine);
            setInterval(createObstacle, 2000);
            setInterval(increaseGameSpeed, 5000);
            setInterval(updateDepth, 1000);
            bgMusic.play();
        }

        startGame();
    </script>
</body>
</html>
